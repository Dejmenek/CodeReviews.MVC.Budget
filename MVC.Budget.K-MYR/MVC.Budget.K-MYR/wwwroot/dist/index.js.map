{"version":3,"file":"index.js","mappings":";;;;;;;;;;;;;;;;;;;AAAA,CAA4B;AACW;AACvC;AACwC;AACmB;AAChC;AAC3B;AACmB;AACC;;;;;;;;;;;;;;;;ACRpB,CAAwC;AACkB;AACa;AACvE;AACA;AACA;AACA,eAAe,uEAAqB;AACpC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,gBAAgB,CAAC;AACjB,oBAAoB,kBAAkB;AACtC;AACA,+DAA+D,GAAG;AAClE,oCAAoC,0DAA0D,IAAI,0DAA0D;AAC5J,iEAAiE,GAAG;AACpE,sCAAsC,4DAA4D,IAAI,4DAA4D;AAClK;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,GAAG;AACjE;AACA;AACA;AACA;AACA,6DAA6D,GAAG;AAChE;AACA,QAAQ,CAAC;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,YAAY,CAAC;AACb;AACA,kBAAkB,oDAAc;AAChC;AACA,KAAK;AACL;AACA;AACA;AACA,YAAY,CAAC;AACb;AACA;AACA,kCAAkC,mDAAa;AAC/C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAgB;AAC9C;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI,CAAC;AACL;AACA;AACA;AACA,8DAA8D,kBAAkB;AAChF;AACA;AACA;AACA;AACA,4DAA4D,kBAAkB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gDAAW;AAC9C;AACA,KAAK;AACL","sources":["webpack://thebudgeteer/../../../../../C\u0000# Academy Repos/CodeReviews.MVC.Budget/MVC.Budget.K-MYR/MVC.Budget.K-MYR/ClientApp/src/js/index-entry.js","webpack://thebudgeteer/../../../../../C\u0000# Academy Repos/CodeReviews.MVC.Budget/MVC.Budget.K-MYR/MVC.Budget.K-MYR/ClientApp/src/js/index.js"],"sourcesContent":["﻿import 'jquery-validation';\r\nimport 'jquery-validation-unobtrusive';\r\n\r\nimport '../scss/bootstrap-imports.scss';\r\nimport 'country-select-js/build/css/countrySelect.min.css';\r\nimport '../scss/site.scss';\r\n\r\nimport './site.js';\r\nimport './index.js';\r\n","﻿import { PAGE_ROUTES } from './config';\r\nimport { importBootstrapModals } from './asyncComponents';\r\nimport { putFiscalPlan, deleteFiscalPlan, postFiscalPlan } from './api'\r\n\r\nformatDashboard();\r\n\r\nconst modals = importBootstrapModals();\r\nsetupModalHandlers();\r\n\r\nwindow.addEventListener('countryChanged', () => {\r\n    formatDashboard();\r\n});\r\n\r\nfunction formatDashboard() {\r\n    var cards = $('.fiscalPlan-card');\r\n    for (let i = 0; i < cards.length; i++) {\r\n        let id = cards[i].dataset.id;\r\n        let incomeText = document.getElementById(`fiscalPlan_${id}_income`);\r\n        incomeText.textContent = `${window.userNumberFormat.format(incomeText.dataset.total)} / ${window.userNumberFormat.format(incomeText.dataset.budget)}`;\r\n        let expensesText = document.getElementById(`fiscalPlan_${id}_expenses`);\r\n        expensesText.textContent = `${window.userNumberFormat.format(expensesText.dataset.total)} / ${window.userNumberFormat.format(expensesText.dataset.budget)}`;\r\n    }\r\n}\r\n\r\nfunction updateFiscalPlan(formData) {\r\n    var id = formData.get('Id');\r\n    var name = formData.get('Name');\r\n    var header = document.getElementById(`fiscalPlan-header_${id}`);\r\n    header.textContent = name;\r\n}\r\n\r\nfunction removeFiscalPlan(id) {\r\n    var element = document.getElementById(`fiscalPlan-card_${id}`);\r\n    if (element) {\r\n        $(element).off();\r\n        element.remove();\r\n    }\r\n}\r\n\r\nasync function setupModalHandlers() {\r\n    var modalsArray = await modals;\r\n    var addModal = modalsArray.find(m => m._element.id == 'addFiscalPlan-modal');\r\n    var updateModal = modalsArray.find(m => m._element.id == 'updateFiscalPlan-modal');\r\n    var updateModalLabel = document.getElementById('updateFiscalPlan-label');\r\n    var updateModalId = document.getElementById('updateFiscalPlan_id');\r\n    var updateModalName = document.getElementById('updateFiscalPlan_name');\r\n    var deleteModal = modalsArray.find(m => m._element.id == 'deleteFiscalPlan-modal');\r\n    var deleteModalLabel = document.getElementById('deleteFiscalPlan-label');\r\n    var deleteModalId = document.getElementById('deleteFiscalPlan_id');\r\n\r\n    document.getElementById('addFiscalPlan-card').addEventListener('click', function () {\r\n        addModal.show();\r\n    });\r\n    document.getElementById('addFiscalPlan-form').addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        if ($(this).valid()) {\r\n            addModal.hide();\r\n            await postFiscalPlan(new FormData(this));\r\n        }\r\n    });\r\n\r\n    document.getElementById('updateFiscalPlan-form').addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        if ($(this).valid()) {\r\n            updateModal.hide();\r\n            let formData = new FormData(this);\r\n            let isUpdated = await putFiscalPlan(formData);\r\n            if (isUpdated) {\r\n                updateFiscalPlan(formData);\r\n            }\r\n        }\r\n    });\r\n\r\n    document.getElementById('deleteFiscalPlan-form').addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        deleteModal.hide();\r\n        var formData = new FormData(this);\r\n        var id = formData.get('Id');\r\n        var token = formData.get('__RequestVerificationToken');\r\n        var isDeleted = await deleteFiscalPlan(id, token);\r\n        if (isDeleted) {\r\n            removeFiscalPlan(id);\r\n        }\r\n    });\r\n\r\n    $('.fiscalPlan-card').on('click', function (event) {\r\n        if (event.target.matches('.fiscalPlan-icon')) {\r\n            switch (event.target.dataset.action) {\r\n                case 'delete':\r\n                    deleteModalLabel.textContent = `Delete '${this.dataset.name}'?`;\r\n                    deleteModalId.value = this.dataset.id;\r\n                    deleteModal.show();\r\n                    break;\r\n                case 'edit':\r\n                    updateModalLabel.textContent = `Edit '${this.dataset.name}'`;\r\n                    updateModalId.value = this.dataset.id;\r\n                    updateModalName.value = this.dataset.name;\r\n                    updateModal.show();\r\n                    break;\r\n            }\r\n        }\r\n        else {\r\n            window.location.href = PAGE_ROUTES.FISCAL_PLAN(this.dataset.id);\r\n        }\r\n    });\r\n}\r\n"],"names":[],"sourceRoot":""}