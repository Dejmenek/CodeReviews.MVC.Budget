{"version":3,"file":"index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,CAA4B;AACW;AACvC;AACwC;AACmB;AAChC;AAC3B;AACmB;AACC;;;;;;;;;;;;;;;;;;;;;ACRpB,CAAwC;AACkB;AACa;AACjC;AACY;AAClD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,eAAe,uEAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAoB;AACpB;AACA;AACA,gBAAgB,CAAC;AACjB,oBAAoB,kBAAkB;AACtC;AACA,sEAAsE,GAAG;AACzE,oCAAoC,0DAA0D,IAAI,0DAA0D;AAC5J,0EAA0E,GAAG;AAC7E,sCAAsC,4DAA4D,IAAI,4DAA4D;AAClK;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,cAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,cAAc;AACxD,iCAAiC,mCAAmC,KAAK,kCAAkC;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,cAAc;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,mCAAmC,mCAAmC,KAAK,kCAAkC;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,cAAc;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,GAAG;AACjE;AACA,0DAA0D,GAAG;AAC7D;AACA;AACA;AACA;AACA,6DAA6D,GAAG;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,CAAC;AAClC;AACA,iCAAiC,oDAAc;AAC/C;AACA;AACA;AACA,YAAY,mDAAU,cAAc,oFAAoF;AACxH,YAAY,mDAAU;AACtB;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oCAAoC,CAAC;AACrC;AACA;AACA,iCAAiC,mDAAa;AAC9C;AACA;AACA;AACA,YAAY,mDAAU,cAAc,oFAAoF;AACxH,YAAY,mDAAU;AACtB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,sDAAgB;AACjD;AACA;AACA;AACA,YAAY,mDAAU,cAAc,oFAAoF;AACxH,YAAY,mDAAU;AACtB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,4BAA4B;AACtF;AACA;AACA;AACA;AACA,wDAAwD,4BAA4B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,gDAAW;AAC1C;AACA;AACA;AACA;AACA,2BAA2B,qbAA+E;AAC1G;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA,KAAK;AACL;AACA","sources":["webpack://thebudgeteer/../../../../../../C\u0000#/GithubRepositories/CodeReviews.MVC.Budget/MVC.Budget.K-MYR/MVC.Budget.K-MYR/ClientApp/src/js/index-entry.js","webpack://thebudgeteer/../../../../../../C\u0000#/GithubRepositories/CodeReviews.MVC.Budget/MVC.Budget.K-MYR/MVC.Budget.K-MYR/ClientApp/src/js/index.js"],"sourcesContent":["﻿import 'jquery-validation';\r\nimport 'jquery-validation-unobtrusive';\r\n\r\nimport '../scss/bootstrap-imports.scss';\r\nimport 'country-select-js/build/css/countrySelect.min.css';\r\nimport '../scss/site.scss';\r\n\r\nimport './site.js';\r\nimport './index.js';\r\n","﻿import { PAGE_ROUTES } from './config';\r\nimport { importBootstrapModals } from './asyncComponents';\r\nimport { putFiscalPlan, deleteFiscalPlan, postFiscalPlan } from './api'\r\nimport messageBox from \"./messageBox\";\r\nimport { setupRefocusHandlers } from './utilities'\r\n\r\nconst cardsContainer = document.getElementById('cards-container');\r\nformatDashboard();\r\nwindow.addEventListener('countryChanged', () => {\r\n    formatDashboard();\r\n});\r\n\r\nconst modals = importBootstrapModals();\r\nconst tooltips = getTooltips();\r\nvar modalsArray = await modals;\r\nvar addModal = modalsArray.find(m => m._element.id == 'addFiscalPlan-modal');\r\nvar updateModal = modalsArray.find(m => m._element.id == 'updateFiscalPlan-modal');\r\nvar updateModalLabel = document.getElementById('updateFiscalPlan-label');\r\nvar updateModalId = document.getElementById('updateFiscalPlan_id');\r\nvar updateModalName = document.getElementById('updateFiscalPlan_name');\r\nvar deleteModal = modalsArray.find(m => m._element.id == 'deleteFiscalPlan-modal');\r\nvar deleteModalLabel = document.getElementById('deleteFiscalPlan-label');\r\nvar deleteModalId = document.getElementById('deleteFiscalPlan_id');\r\nsetupModalHandlers(modals);\r\nsetupRefocusHandlers();\r\n\r\nfunction formatDashboard() {\r\n    var cards = $('.fiscalPlan-card');\r\n    for (let i = 0; i < cards.length; i++) {\r\n        let id = cards[i].dataset.id;\r\n        let incomeText = document.getElementById(`fiscalPlan_income_${id}`);\r\n        incomeText.textContent = `${window.userNumberFormat.format(incomeText.dataset.total)} / ${window.userNumberFormat.format(incomeText.dataset.budget)}`;\r\n        let expensesText = document.getElementById(`fiscalPlan_expenses_${id}`);\r\n        expensesText.textContent = `${window.userNumberFormat.format(expensesText.dataset.total)} / ${window.userNumberFormat.format(expensesText.dataset.budget)}`;\r\n    }\r\n}\r\n\r\nfunction addFiscalPlan(fiscalPlan, beforeElement) {   \r\n    var card = document.createElement('div');\r\n    card.className = 'fiscalPlan-card';\r\n    card.id = `fiscalPlan-card_${fiscalPlan.id}`;\r\n    card.setAttribute('data-id', fiscalPlan.id);\r\n    card.setAttribute('data-name', fiscalPlan.name);\r\n    card.tabIndex = 0;\r\n\r\n    var headerContainer = document.createElement('div');\r\n    headerContainer.className = 'd-flex justify-content-between gap-1';\r\n\r\n    var editIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    editIcon.setAttribute('viewBox', '0 0 14 14');\r\n    editIcon.setAttribute('height', '30');\r\n    editIcon.setAttribute('width', '30');\r\n    editIcon.setAttribute('class', 'fiscalPlan-icon');\r\n    editIcon.setAttribute('fill', '#ffffff');\r\n    editIcon.setAttribute('data-action', 'edit');\r\n    editIcon.tabIndex = 0;\r\n    var editUse = document.createElementNS(\"http://www.w3.org/2000/svg\", \"use\");\r\n    editUse.setAttribute('href', '#edit-icon');\r\n    editIcon.appendChild(editUse);\r\n\r\n    var heading = document.createElement('h1');\r\n    heading.id = `fiscalPlan-header_${fiscalPlan.id}`;\r\n    heading.class = 'fiscalPlan-heading';\r\n    heading.textContent = fiscalPlan.name;\r\n\r\n    var deleteIcon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    deleteIcon.setAttribute('viewBox', '0 0 14 14');\r\n    deleteIcon.setAttribute('height', '30');\r\n    deleteIcon.setAttribute('width', '30');\r\n    deleteIcon.setAttribute('class', 'fiscalPlan-icon');\r\n    deleteIcon.setAttribute('fill', '#ffffff');\r\n    deleteIcon.setAttribute('data-action', 'delete');\r\n    deleteIcon.tabIndex = 0;\r\n    var deleteUse = document.createElementNS(\"http://www.w3.org/2000/svg\", \"use\");\r\n    deleteUse.setAttribute('href', '#trash-icon');\r\n    deleteIcon.appendChild(deleteUse);\r\n\r\n    headerContainer.appendChild(editIcon);\r\n    headerContainer.appendChild(heading);\r\n    headerContainer.appendChild(deleteIcon);\r\n\r\n    var progressContainer = document.createElement('div');\r\n    progressContainer.className = 'progress-container';\r\n\r\n    var incomeSection = document.createElement('div');\r\n    var incomeTitleContainer = document.createElement('div');\r\n    incomeTitleContainer.className = 'd-flex justify-content-between';\r\n    var incomeTitle = document.createElement('div');\r\n    incomeTitle.textContent = 'Income';\r\n    var incomeTotal = document.createElement('div');\r\n    incomeTotal.id = `fiscalPlan_income_${fiscalPlan.id}`;\r\n    incomeTotal.textContent = `${window.userNumberFormat.format(0)} /  ${window.userNumberFormat.format(0)}`;\r\n\r\n    incomeTitleContainer.appendChild(incomeTitle);\r\n    incomeTitleContainer.appendChild(incomeTotal);\r\n    incomeSection.appendChild(incomeTitleContainer);\r\n\r\n    var incomeProgressDiv = document.createElement('div');\r\n    incomeProgressDiv.className = 'progress';\r\n    var incomeProgressBar = document.createElement('div');\r\n    incomeProgressBar.className = 'progress-bar bg-success';\r\n    incomeProgressBar.setAttribute('role', 'progressbar');\r\n    incomeProgressBar.style.width = '100%'; \r\n    incomeProgressBar.setAttribute('aria-valuenow', '100');\r\n    incomeProgressBar.setAttribute('aria-valuemin', '0');\r\n    incomeProgressBar.setAttribute('aria-valuemax', '100');\r\n    incomeProgressBar.setAttribute('aria-labelledby', `fiscalPlan_balance_${fiscalPlan.id}`);\r\n\r\n    incomeProgressDiv.appendChild(incomeProgressBar);\r\n    incomeSection.appendChild(incomeProgressDiv);\r\n\r\n    var expensesSection = document.createElement('div');\r\n    var expensesTitleContainer = document.createElement('div');\r\n    expensesTitleContainer.className = 'd-flex justify-content-between';\r\n    var expensesTitle = document.createElement('div');\r\n    expensesTitle.textContent = 'Expenses';\r\n    var expensesTotal = document.createElement('div');\r\n    expensesTotal.id = `fiscalPlan_expenses_${fiscalPlan.id}`;\r\n    expensesTotal.textContent = `${window.userNumberFormat.format(0)} /  ${window.userNumberFormat.format(0)}`;\r\n            \r\n    expensesTitleContainer.appendChild(expensesTitle);\r\n    expensesTitleContainer.appendChild(expensesTotal);\r\n    expensesSection.appendChild(expensesTitleContainer);\r\n\r\n    var expensesProgressDiv = document.createElement('div');\r\n    expensesProgressDiv.className = 'progress';\r\n    var expensesProgressBar = document.createElement('div');\r\n    expensesProgressBar.className = 'progress-bar bg-danger';\r\n    expensesProgressBar.setAttribute('role', 'progressbar');\r\n    expensesProgressBar.style.width = '100%';\r\n    expensesProgressBar.setAttribute('aria-valuenow', '100');\r\n    expensesProgressBar.setAttribute('aria-valuemin', '0');\r\n    expensesProgressBar.setAttribute('aria-valuemax', '100');\r\n    expensesProgressBar.setAttribute('aria-labelledby', `fiscalPlan_balance_${fiscalPlan.id}`);\r\n\r\n    expensesProgressDiv.appendChild(expensesProgressBar);\r\n    expensesSection.appendChild(expensesProgressDiv);\r\n    progressContainer.appendChild(incomeSection);\r\n    progressContainer.appendChild(expensesSection);\r\n    card.appendChild(headerContainer);\r\n    card.appendChild(progressContainer);\r\n    card.addEventListener('click', onFiscalPlanClick);\r\n    card.addEventListener('keydown', onFiscalPlanClick);\r\n\r\n    cardsContainer.insertBefore(card, beforeElement);\r\n}\r\n\r\nfunction updateFiscalPlan(formData) {\r\n    var id = formData.get('Id');\r\n    var name = formData.get('Name');\r\n    var header = document.getElementById(`fiscalPlan-header_${id}`);\r\n    header.textContent = name;\r\n    var card = document.getElementById(`fiscalPlan-card_${id}`);\r\n    card.dataset.name = name;\r\n}\r\n\r\nfunction removeFiscalPlan(id) {\r\n    var element = document.getElementById(`fiscalPlan-card_${id}`);\r\n    if (element) {\r\n        element.removeEventListener('click', handleFiscalPlanInteraction);\r\n        element.remove();\r\n    }\r\n}\r\n\r\nasync function setupModalHandlers() {   \r\n    var addfiscalPlanCard = document.getElementById('addFiscalPlan-card');\r\n    \r\n    var addFiscalPlanForm = document.getElementById('addFiscalPlan-form');\r\n    addFiscalPlanForm.addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        if (addModal._isShown && $(this).valid()) {\r\n            addModal.hide();\r\n            var response = await postFiscalPlan(new FormData(this));\r\n            if (response.isSuccess) {\r\n                addFiscalPlan(response.data, addfiscalPlanCard);\r\n            }\r\n            messageBox.addMessage({ text: response.message, iconId: response.isSuccess ? '#check-icon' : '#cross-icon' });\r\n            messageBox.show();\r\n        }\r\n    });\r\n    addfiscalPlanCard.addEventListener('click', function () {\r\n        addModal.show();\r\n    });\r\n    addfiscalPlanCard.addEventListener('keydown', function (event) {\r\n        if (event.key == 'Enter') {\r\n            addModal.show();\r\n        }\r\n    });\r\n\r\n    var updateFiscalPlanForm = document.getElementById('updateFiscalPlan-form');\r\n    updateFiscalPlanForm.addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        if (updateModal._isShown && $(this).valid()) {\r\n            updateModal.hide();\r\n            let formData = new FormData(this);\r\n            let response = await putFiscalPlan(formData);\r\n            if (response.isSuccess) {\r\n                updateFiscalPlan(formData);\r\n            }            \r\n            messageBox.addMessage({ text: response.message, iconId: response.isSuccess ? '#check-icon' : '#cross-icon' });\r\n            messageBox.show();\r\n        }\r\n    });\r\n\r\n    var deleteFiscalPlanForm = document.getElementById('deleteFiscalPlan-form');\r\n    deleteFiscalPlanForm.addEventListener('submit', async function (event) {\r\n        event.preventDefault();\r\n        if (deleteModal._isShown) {\r\n            deleteModal.hide();\r\n            var formData = new FormData(this);\r\n            var id = formData.get('Id');\r\n            var token = formData.get('__RequestVerificationToken');\r\n            var response = await deleteFiscalPlan(id, token);\r\n            if (response.isSuccess) {\r\n                removeFiscalPlan(id);\r\n            }\r\n            messageBox.addMessage({ text: response.message, iconId: response.isSuccess ? '#check-icon' : '#cross-icon' });\r\n            messageBox.show();\r\n        }\r\n    });\r\n\r\n    cardsContainer.querySelectorAll('.fiscalPlan-card')\r\n        .forEach(element => {\r\n            element.addEventListener(\"click\", handleFiscalPlanInteraction)\r\n            element.addEventListener(\"keydown\", handleFiscalPlanInteraction)\r\n        });\r\n}\r\n\r\nfunction handleFiscalPlanInteraction(event) {\r\n    if (event.type === 'click' || (event.type === 'keydown' && event.key === 'Enter')) {\r\n        onFiscalPlanClick(event);\r\n    }\r\n}\r\n\r\nfunction onFiscalPlanClick(event) {\r\n    var fiscalPlanCard = event.currentTarget;\r\n    var id = parseInt(fiscalPlanCard.dataset.id);\r\n\r\n    if (event.target.matches('.fiscalPlan-icon')) {        \r\n        switch (event.target.dataset.action) {\r\n            case 'delete':              \r\n                deleteModalLabel.textContent = `Delete '${fiscalPlanCard.dataset.name}'?`;\r\n                deleteModalId.value = id;\r\n                deleteModal.show();\r\n                break;\r\n            case 'edit':              \r\n                updateModalLabel.textContent = `Edit '${fiscalPlanCard.dataset.name}'`;\r\n                updateModalId.value = id;\r\n                updateModalName.value = fiscalPlanCard.dataset.name;\r\n                updateModal.show();\r\n                break;\r\n        }\r\n    }\r\n    else {        \r\n        window.location.href = PAGE_ROUTES.FISCAL_PLAN(id);\r\n    }\r\n}\r\n\r\nasync function getTooltips() {\r\n    const Tooltip = (await import(/* webpackChunkName: \"bootstrap-tooltips\" */'bootstrap/js/dist/tooltip')).default;\r\n    var tooltipElements = document.querySelectorAll('.tooltipped');\r\n    var tooltips = [...tooltipElements].map(element => new Tooltip(element, {\r\n        container: 'body',\r\n        delay: { show: 500, hide: 0 },\r\n        placement: 'top',\r\n        offset: [0, 10]       \r\n    }));\r\n    return tooltips;\r\n}\r\n"],"names":[],"sourceRoot":""}